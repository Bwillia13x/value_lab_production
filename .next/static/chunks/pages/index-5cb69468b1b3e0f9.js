(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(1003)}])},1003:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return R}});var r=a(5893),s=a(7294),n=a(9008),l=a.n(n),i=a(9085),d=a(9221),c=a(3299),o=a(1571),h=()=>{let{theme:e,setTheme:t}=(0,o.F)();return(0,r.jsxs)("button",{onClick:()=>t("light"===e?"dark":"light"),className:"p-2 rounded-md bg-primary-light dark:bg-primary-dark text-white",children:["light"===e?"Dark":"Light"," Mode"]})},u=a(9762),x=a(1976),m=a.n(x),p=a(3454);let g=m()({key:p.env.ALPHA_VANTAGE_API_KEY});async function f(e){try{return await g.fundamental.company_overview(e)}catch(e){return console.error("Error fetching fundamentals:",e),null}}var b=a(1819),y=a(5114),j=a(3300),w=a.n(j);async function v(e){try{let t=await w()("https://api.example.com/sentiment?ticker=".concat(e));return await t.json()}catch(e){return console.error("Error fetching market sentiment:",e),{sentiment:"neutral",score:.5}}}async function N(e){let t=await w()("http://localhost:3001/fund/".concat(e)),a=await t.json();if(!t.ok)throw Error(a.error||"Error fetching data from fund data service");return a}async function k(e,t){let{series:a}=await N(e),r=t(a.map(e=>e.return).filter(e=>null!==e)),s=r.reduce((e,t)=>e*(1+t),100),n=r.length/12,l=100,i=0,d=100;for(let e of r){(d*=1+e)>l&&(l=d);let t=(l-d)/l;t>i&&(i=t)}return{finalValue:s,cagr:Math.pow(s/100,1/n)-1,maxDrawdown:i}}i.kL.register(d.ZP);var R=()=>{var e,t;let{data:a,status:n}=(0,c.useSession)(),[d,o]=(0,s.useState)(["SPY"]),[x,m]=(0,s.useState)([]),[p,g]=(0,s.useState)({}),[j,w]=(0,s.useState)({}),[N,R]=(0,s.useState)([]),[F,S]=(0,s.useState)(null),[C,E]=(0,s.useState)({currentEps:10,growthRate:.05,discountRate:.1,terminalGrowthRate:.02,years:10}),[A,D]=(0,s.useState)(null),[_,P]=(0,s.useState)(null),[M,V]=(0,s.useState)(!1),G=(0,s.useRef)(null),I=(0,s.useRef)(null),T=(0,s.useRef)(null),L=(0,s.useRef)(null),O=async()=>{try{let e=await fetch("/api/funds");if(!e.ok)throw Error("API error");let t=await e.json();m(t)}catch(e){alert(e.message||e)}},B=async e=>{V(!0);let t={},a={};for(let r of e)try{let e=await fetch("/api/fund/".concat(encodeURIComponent(r)));if(!e.ok)throw Error("API error");let{series:s,metrics:n}=await e.json();t[r]=s,a[r]={...W(s),...n};let l=await v(r);D(l)}catch(e){alert(e.message||e)}g(t),w(a),V(!1)},W=e=>{if(0===e.length)return{cagr:0,maxDD:0};let t=e[0].price,a=e[e.length-1].price,r=(e.length-1)/12,s=e[0].index,n=0;return e.forEach(e=>{e.index>s&&(s=e.index);let t=(s-e.index)/s;t>n&&(n=t)}),{cagr:Math.pow(a/t,1/r)-1,maxDD:n}},Y=async()=>{let e=await f(d[0]);if(e){let t={...C,currentEps:parseFloat(e.EPS)};E(t),S(function(e){let{currentEps:t,growthRate:a,discountRate:r,terminalGrowthRate:s,years:n}=e,l=t,i=0;for(let e=0;e<n;e++)l*=1+a,i+=l/Math.pow(1+r,e+1);return i+l*(1+s)/(r-s)/Math.pow(1+r,n)}(t))}},Z=async()=>{P(await k(null,d[0],e=>(e.slice(0,20).reduce((e,t)=>e+t,0),e.slice(0,50).reduce((e,t)=>e+t,0),e.map((t,a)=>a<50?t:e.slice(a-20,a).reduce((e,t)=>e+t,0)/20>e.slice(a-50,a).reduce((e,t)=>e+t,0)/50?t:-t))))};return((0,s.useEffect)(()=>{"authenticated"===n&&O()},[n]),(0,s.useEffect)(()=>{"authenticated"===n&&d.length>0&&B(d)},[d,n]),(0,s.useEffect)(()=>{if(G.current){T.current&&T.current.destroy();let t=G.current.getContext("2d");if(t){var e;let a=Object.keys(p).map((e,t)=>{let a=["#06b6d4","#f87171","#4ade80","#facc15","#a78bfa"];return{label:e,data:p[e].map(e=>e.index),borderColor:a[t%a.length],borderWidth:2,fill:!1}});T.current=new i.kL(t,{type:"line",data:{labels:(null===(e=p[Object.keys(p)[0]])||void 0===e?void 0:e.map(e=>e.date))||[],datasets:a},options:{responsive:!0,maintainAspectRatio:!0,plugins:{zoom:{pan:{enabled:!0,mode:"x"},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x"}},tooltip:{callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),null!==e.parsed.y&&(t+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.parsed.y)),t}}}}}})}}},[p]),(0,s.useEffect)(()=>{if(I.current&&N.length>0){L.current&&L.current.destroy();let e=I.current.getContext("2d");if(e){let t=N.map((e,t)=>({label:"Simulation ".concat(t+1),data:e.map(e=>e.value),borderColor:"rgba(103, 232, 249, ".concat(1/N.length*10,")"),borderWidth:1,fill:!1}));L.current=new i.kL(e,{type:"line",data:{labels:Array.from({length:N[0].length},(e,t)=>t+1),datasets:t},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1},tooltip:{enabled:!1}}}})}}},[N]),"loading"===n)?(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}):"unauthenticated"===n?((0,c.signIn)(),(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:"Redirecting to sign-in..."})):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{children:[(0,r.jsx)("title",{children:"Value Lab â€“ Fund Viewer"}),(0,r.jsx)("link",{rel:"stylesheet",href:"https://rsms.me/inter/inter.css"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900 min-h-screen font-sans",children:[(0,r.jsxs)("div",{className:"prose dark:prose-invert mx-auto text-center py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-3 text-primary dark:text-primary-light",children:"Fund Return Viewer"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(h,{}),(0,r.jsx)("span",{className:"ml-4 text-gray-600 dark:text-gray-300",children:null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.organizationName}),(0,r.jsx)("span",{className:"ml-4 text-gray-600 dark:text-gray-300",children:null==a?void 0:null===(t=a.user)||void 0===t?void 0:t.email}),(0,r.jsx)("button",{onClick:()=>(0,c.signOut)(),className:"ml-4 bg-secondary hover:bg-secondary-dark text-white px-4 py-2 rounded-md",children:"Sign Out"})]})]}),(0,r.jsxs)("div",{className:"flex justify-center gap-2 mb-6",children:[(0,r.jsx)("select",{multiple:!0,value:d,onChange:e=>{let t=e.target.options,a=[];for(let e=0,r=t.length;e<r;e++)t[e].selected&&a.push(t[e].value);o(a)},className:"border rounded-md px-2 py-1 w-64 text-center bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:x.map(e=>(0,r.jsx)("option",{value:e.ticker,children:e.name},e.ticker))}),(0,r.jsx)("button",{onClick:()=>{(function(e,t,a){let r=new b.ZP;return r.text("Value Lab Report",14,16),(0,y.ZP)(r,{startY:22,head:[["Ticker","CAGR","Max Drawdown","VaR (95%)","ES (95%)","Beta","Sharpe Ratio"]],body:Object.keys(t).map(e=>[e,"".concat((100*t[e].cagr).toFixed(2)," %"),"".concat((100*t[e].maxDD).toFixed(2)," %"),"".concat((100*t[e].var).toFixed(2)," %"),"".concat((100*t[e].es).toFixed(2)," %"),t[e].beta.toFixed(2),t[e].sharpe.toFixed(2)])}),r.addPage(),r.text("Monte Carlo Simulation",14,16),(0,y.ZP)(r,{startY:22,head:[["Simulation","Final Value"]],body:a.map((e,t)=>["Simulation ".concat(t+1),e[e.length-1].value.toFixed(2)])}),r})(0,j,N).save("value-lab-report.pdf")},className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Generate Report"})]})]}),(0,r.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:(0,r.jsx)("canvas",{ref:G,id:"chart",style:{display:"block",width:"100%",maxWidth:"100%",height:"420px"}})}),(0,r.jsx)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:(0,r.jsxs)("table",{className:"table-auto w-full text-left",children:[(0,r.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-700",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-2",children:"Ticker"}),(0,r.jsx)("th",{className:"px-4 py-2",children:"CAGR"}),(0,r.jsx)("th",{className:"px-4 py-2",children:"Max Drawdown"}),(0,r.jsx)("th",{className:"px-4 py-2",children:"VaR (95%)"}),(0,r.jsx)("th",{className:"px-4 py-2",children:"ES (95%)"}),(0,r.jsx)("th",{className:"px-4 py-2",children:"Beta"}),(0,r.jsx)("th",{className:"px-4 py-2",children:"Sharpe Ratio"})]})}),(0,r.jsx)("tbody",{children:Object.keys(j).map(e=>(0,r.jsxs)("tr",{className:"border-b dark:border-gray-700",children:[(0,r.jsx)("td",{className:"px-4 py-2",children:e}),(0,r.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].cagr).toFixed(2)," %"]}),(0,r.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].maxDD).toFixed(2)," %"]}),(0,r.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].var).toFixed(2)," %"]}),(0,r.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].es).toFixed(2)," %"]}),(0,r.jsx)("td",{className:"px-4 py-2",children:j[e].beta.toFixed(2)}),(0,r.jsx)("td",{className:"px-4 py-2",children:j[e].sharpe.toFixed(2)})]},e))})]})}),(0,r.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Monte Carlo Simulation"}),(0,r.jsx)("button",{onClick:()=>{R(function(e,t,a){let r=e.map(e=>e/12),s=(0,u.J69)(...r),n=(0,u.qoR)(...r),l=[];for(let e=0;e<100;e++){let e=[],t=100;for(let a=0;a<120;a++)t*=1+(s+(2*(0,u.MXc)()-1)*n),e.push({period:a+1,value:t});l.push(e)}return l}(p[d[0]].map(e=>e.return).filter(e=>null!==e),0,0))},className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Run Simulation"}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("canvas",{ref:I,id:"simulationChart",style:{display:"block",width:"100%",maxWidth:"100%",height:"420px"}})})]}),(0,r.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"DCF Analysis"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block",children:"Current EPS"}),(0,r.jsx)("input",{type:"number",value:C.currentEps,onChange:e=>E({...C,currentEps:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block",children:"Growth Rate (%)"}),(0,r.jsx)("input",{type:"number",value:100*C.growthRate,onChange:e=>E({...C,growthRate:parseFloat(e.target.value)/100}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block",children:"Discount Rate (%)"}),(0,r.jsx)("input",{type:"number",value:100*C.discountRate,onChange:e=>E({...C,discountRate:parseFloat(e.target.value)/100}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block",children:"Terminal Growth Rate (%)"}),(0,r.jsx)("input",{type:"number",value:100*C.terminalGrowthRate,onChange:e=>E({...C,terminalGrowthRate:parseFloat(e.target.value)/100}),className:"w-full px-3 py-2 border rounded"})]})]}),(0,r.jsx)("button",{onClick:Y,className:"mt-4 bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Run DCF"}),F&&(0,r.jsxs)("div",{className:"mt-4 text-xl font-bold",children:["Intrinsic Value: ",F.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Backtesting"}),(0,r.jsx)("button",{onClick:Z,className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Run Backtest"}),_&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"Backtest Result"}),(0,r.jsxs)("div",{children:["Final Value: ",_.finalValue.toFixed(2)]}),(0,r.jsxs)("div",{children:["CAGR: ",(100*_.cagr).toFixed(2)," %"]}),(0,r.jsxs)("div",{children:["Max Drawdown: ",(100*_.maxDrawdown).toFixed(2)," %"]})]})]}),(0,r.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"AI-Powered Insights"}),A&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"Market Sentiment"}),(0,r.jsxs)("div",{children:["Sentiment: ",A.sentiment]}),(0,r.jsxs)("div",{children:["Score: ",A.score]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"Automated Analysis"}),(0,r.jsx)("p",{children:"Based on the current market conditions and the selected fund's performance, our AI has identified the following insights:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside",children:[(0,r.jsx)("li",{children:"The fund has a strong track record of outperforming the market during periods of high inflation."}),(0,r.jsx)("li",{children:"The fund's current valuation is attractive compared to its historical average."}),(0,r.jsx)("li",{children:"The fund's portfolio is well-diversified across a range of sectors and industries."})]})]})]})]})]})]})}},5042:function(){}},function(e){e.O(0,[196,847,431,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);