(()=>{var e={};e.id=405,e.ids=[405,888,660],e.modules={1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},1420:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>g,default:()=>h,getServerSideProps:()=>p,getStaticPaths:()=>m,getStaticProps:()=>x,reportWebVitals:()=>f,routeModule:()=>N,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>b});var s=r(7093),n=r(5244),l=r(1323),i=r(2899),d=r.n(i),c=r(6814),o=r(6209),u=e([c,o]);[c,o]=u.then?(await u)():u;let h=(0,l.l)(o,"default"),x=(0,l.l)(o,"getStaticProps"),m=(0,l.l)(o,"getStaticPaths"),p=(0,l.l)(o,"getServerSideProps"),g=(0,l.l)(o,"config"),f=(0,l.l)(o,"reportWebVitals"),b=(0,l.l)(o,"unstable_getStaticProps"),y=(0,l.l)(o,"unstable_getStaticPaths"),j=(0,l.l)(o,"unstable_getStaticParams"),v=(0,l.l)(o,"unstable_getServerProps"),w=(0,l.l)(o,"unstable_getServerSideProps"),N=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/index",pathname:"/",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:o});a()}catch(e){a(e)}})},8767:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>i});var s=r(997),n=r(690),l=e([n]);n=(l.then?(await l)():l)[0];let i=()=>{let{theme:e,setTheme:t}=(0,n.useTheme)();return(0,s.jsxs)("button",{onClick:()=>t("light"===e?"dark":"light"),className:"p-2 rounded-md bg-primary-light dark:bg-primary-dark text-white",children:["light"===e?"Dark":"Light"," Mode"]})};a()}catch(e){a(e)}})},6814:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>d});var s=r(997),n=r(1649),l=r(690);r(6764);var i=e([l]);l=(i.then?(await i)():i)[0];let d=function({Component:e,pageProps:{session:t,...r}}){return s.jsx(n.SessionProvider,{session:t,children:s.jsx(l.ThemeProvider,{attribute:"class",children:s.jsx(e,{...r})})})};a()}catch(e){a(e)}})},6209:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>j});var s=r(997),n=r(6689),l=r(968),i=r.n(l),d=r(955),c=r(9394),o=r.n(c),u=r(1649),h=r(8767),x=r(6120),m=r(3106),p=r(6747),g=r(852),f=r(5346),b=r(4020),y=e([d,h,x,g]);[d,h,x,g]=y.then?(await y)():y,d.Chart.register(o());let j=()=>{let{data:e,status:t}=(0,u.useSession)(),[r,a]=(0,n.useState)(["SPY"]),[l,c]=(0,n.useState)([]),[o,y]=(0,n.useState)({}),[j,v]=(0,n.useState)({}),[w,N]=(0,n.useState)([]),[k,S]=(0,n.useState)(null),[P,R]=(0,n.useState)({currentEps:10,growthRate:.05,discountRate:.1,terminalGrowthRate:.02,years:10}),[A,E]=(0,n.useState)(null),[F,C]=(0,n.useState)(null),[_,D]=(0,n.useState)(!1),G=(0,n.useRef)(null),M=(0,n.useRef)(null),T=(0,n.useRef)(null),V=(0,n.useRef)(null),I=async()=>{try{let e=await fetch("/api/funds");if(!e.ok)throw Error("API error");let t=await e.json();c(t)}catch(e){alert(e.message||e)}},q=async e=>{D(!0);let t={},r={};for(let a of e)try{let e=await fetch(`/api/fund/${encodeURIComponent(a)}`);if(!e.ok)throw Error("API error");let{series:s,metrics:n}=await e.json();t[a]=s,r[a]={...O(s),...n};let l=await (0,f.R)(a);E(l)}catch(e){alert(e.message||e)}y(t),v(r),D(!1)},O=e=>{if(0===e.length)return{cagr:0,maxDD:0};let t=e[0].price,r=e[e.length-1].price,a=(e.length-1)/12,s=e[0].index,n=0;return e.forEach(e=>{e.index>s&&(s=e.index);let t=(s-e.index)/s;t>n&&(n=t)}),{cagr:Math.pow(r/t,1/a)-1,maxDD:n}},$=async()=>{let e=await (0,p.A)(r[0]);if(e){let t={...P,currentEps:parseFloat(e.EPS)};R(t);let r=(0,m.T)(t);S(r)}},U=async()=>{let e=await (0,b.j)(null,r[0],e=>(e.slice(0,20).reduce((e,t)=>e+t,0),e.slice(0,50).reduce((e,t)=>e+t,0),e.map((t,r)=>{if(r<50)return t;let a=e.slice(r-20,r).reduce((e,t)=>e+t,0)/20,s=e.slice(r-50,r).reduce((e,t)=>e+t,0)/50;return a>s?t:-t})));C(e)};return((0,n.useEffect)(()=>{"authenticated"===t&&I()},[t]),(0,n.useEffect)(()=>{"authenticated"===t&&r.length>0&&q(r)},[r,t]),(0,n.useEffect)(()=>{if(G.current){T.current&&T.current.destroy();let e=G.current.getContext("2d");if(e){let t=Object.keys(o).map((e,t)=>{let r=["#06b6d4","#f87171","#4ade80","#facc15","#a78bfa"];return{label:e,data:o[e].map(e=>e.index),borderColor:r[t%r.length],borderWidth:2,fill:!1}});T.current=new d.Chart(e,{type:"line",data:{labels:o[Object.keys(o)[0]]?.map(e=>e.date)||[],datasets:t},options:{responsive:!0,maintainAspectRatio:!0,plugins:{zoom:{pan:{enabled:!0,mode:"x"},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x"}},tooltip:{callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),null!==e.parsed.y&&(t+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.parsed.y)),t}}}}}})}}},[o]),(0,n.useEffect)(()=>{if(M.current&&w.length>0){V.current&&V.current.destroy();let e=M.current.getContext("2d");if(e){let t=w.map((e,t)=>({label:`Simulation ${t+1}`,data:e.map(e=>e.value),borderColor:`rgba(103, 232, 249, ${1/w.length*10})`,borderWidth:1,fill:!1}));V.current=new d.Chart(e,{type:"line",data:{labels:Array.from({length:w[0].length},(e,t)=>t+1),datasets:t},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1},tooltip:{enabled:!1}}}})}}},[w]),"loading"===t)?s.jsx("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}):"unauthenticated"===t?((0,u.signIn)(),s.jsx("div",{className:"flex items-center justify-center h-screen",children:"Redirecting to sign-in..."})):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{children:[s.jsx("title",{children:"Value Lab â€“ Fund Viewer"}),s.jsx("link",{rel:"stylesheet",href:"https://rsms.me/inter/inter.css"})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900 min-h-screen font-sans",children:[(0,s.jsxs)("div",{className:"prose dark:prose-invert mx-auto text-center py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-3 text-primary dark:text-primary-light",children:"Fund Return Viewer"}),(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx(h.Z,{}),s.jsx("span",{className:"ml-4 text-gray-600 dark:text-gray-300",children:e?.user?.organizationName}),s.jsx("span",{className:"ml-4 text-gray-600 dark:text-gray-300",children:e?.user?.email}),s.jsx("button",{onClick:()=>(0,u.signOut)(),className:"ml-4 bg-secondary hover:bg-secondary-dark text-white px-4 py-2 rounded-md",children:"Sign Out"})]})]}),(0,s.jsxs)("div",{className:"flex justify-center gap-2 mb-6",children:[s.jsx("select",{multiple:!0,value:r,onChange:e=>{let t=e.target.options,r=[];for(let e=0,a=t.length;e<a;e++)t[e].selected&&r.push(t[e].value);a(r)},className:"border rounded-md px-2 py-1 w-64 text-center bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:l.map(e=>s.jsx("option",{value:e.ticker,children:e.name},e.ticker))}),s.jsx("button",{onClick:()=>{(0,g.K)(o,j,w).save("value-lab-report.pdf")},className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Generate Report"})]})]}),(0,s.jsxs)("div",{className:"max-w-5xl mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:s.jsx("canvas",{ref:G,id:"chart",style:{display:"block",width:"100%",maxWidth:"100%",height:"420px"}})}),s.jsx("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:(0,s.jsxs)("table",{className:"table-auto w-full text-left",children:[s.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-4 py-2",children:"Ticker"}),s.jsx("th",{className:"px-4 py-2",children:"CAGR"}),s.jsx("th",{className:"px-4 py-2",children:"Max Drawdown"}),s.jsx("th",{className:"px-4 py-2",children:"VaR (95%)"}),s.jsx("th",{className:"px-4 py-2",children:"ES (95%)"}),s.jsx("th",{className:"px-4 py-2",children:"Beta"}),s.jsx("th",{className:"px-4 py-2",children:"Sharpe Ratio"})]})}),s.jsx("tbody",{children:Object.keys(j).map(e=>(0,s.jsxs)("tr",{className:"border-b dark:border-gray-700",children:[s.jsx("td",{className:"px-4 py-2",children:e}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].cagr).toFixed(2)," %"]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].maxDD).toFixed(2)," %"]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].var).toFixed(2)," %"]}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(100*j[e].es).toFixed(2)," %"]}),s.jsx("td",{className:"px-4 py-2",children:j[e].beta.toFixed(2)}),s.jsx("td",{className:"px-4 py-2",children:j[e].sharpe.toFixed(2)})]},e))})]})}),(0,s.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Monte Carlo Simulation"}),s.jsx("button",{onClick:()=>{let e=o[r[0]].map(e=>e.return).filter(e=>null!==e),t=(0,x.U)(e,100,10);N(t)},className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Run Simulation"}),s.jsx("div",{className:"mt-4",children:s.jsx("canvas",{ref:M,id:"simulationChart",style:{display:"block",width:"100%",maxWidth:"100%",height:"420px"}})})]}),(0,s.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"DCF Analysis"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block",children:"Current EPS"}),s.jsx("input",{type:"number",value:P.currentEps,onChange:e=>R({...P,currentEps:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border rounded"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block",children:"Growth Rate (%)"}),s.jsx("input",{type:"number",value:100*P.growthRate,onChange:e=>R({...P,growthRate:parseFloat(e.target.value)/100}),className:"w-full px-3 py-2 border rounded"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block",children:"Discount Rate (%)"}),s.jsx("input",{type:"number",value:100*P.discountRate,onChange:e=>R({...P,discountRate:parseFloat(e.target.value)/100}),className:"w-full px-3 py-2 border rounded"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block",children:"Terminal Growth Rate (%)"}),s.jsx("input",{type:"number",value:100*P.terminalGrowthRate,onChange:e=>R({...P,terminalGrowthRate:parseFloat(e.target.value)/100}),className:"w-full px-3 py-2 border rounded"})]})]}),s.jsx("button",{onClick:$,className:"mt-4 bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Run DCF"}),k&&(0,s.jsxs)("div",{className:"mt-4 text-xl font-bold",children:["Intrinsic Value: ",k.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Backtesting"}),s.jsx("button",{onClick:U,className:"bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-md",children:"Run Backtest"}),F&&(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"Backtest Result"}),(0,s.jsxs)("div",{children:["Final Value: ",F.finalValue.toFixed(2)]}),(0,s.jsxs)("div",{children:["CAGR: ",(100*F.cagr).toFixed(2)," %"]}),(0,s.jsxs)("div",{children:["Max Drawdown: ",(100*F.maxDrawdown).toFixed(2)," %"]})]})]}),(0,s.jsxs)("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"AI-Powered Insights"}),A&&(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"Market Sentiment"}),(0,s.jsxs)("div",{children:["Sentiment: ",A.sentiment]}),(0,s.jsxs)("div",{children:["Score: ",A.score]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"Automated Analysis"}),s.jsx("p",{children:"Based on the current market conditions and the selected fund's performance, our AI has identified the following insights:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside",children:[s.jsx("li",{children:"The fund has a strong track record of outperforming the market during periods of high inflation."}),s.jsx("li",{children:"The fund's current valuation is attractive compared to its historical average."}),s.jsx("li",{children:"The fund's portfolio is well-diversified across a range of sectors and industries."})]})]})]})]})]})]})};a()}catch(e){a(e)}})},4020:(e,t,r)=>{"use strict";r.d(t,{j:()=>l});var a=r(4809),s=r.n(a);async function n(e){let t=await s()(`http://localhost:3001/fund/${e}`),r=await t.json();if(!t.ok)throw Error(r.error||"Error fetching data from fund data service");return r}async function l(e,t){let{series:r}=await n(e),a=t(r.map(e=>e.return).filter(e=>null!==e)),s=a.reduce((e,t)=>e*(1+t),100),l=a.length/12,i=100,d=0,c=100;for(let e of a){(c*=1+e)>i&&(i=c);let t=(i-c)/i;t>d&&(d=t)}return{finalValue:s,cagr:Math.pow(s/100,1/l)-1,maxDrawdown:d}}},3106:(e,t,r)=>{"use strict";function a(e){let{currentEps:t,growthRate:r,discountRate:a,terminalGrowthRate:s,years:n}=e,l=t,i=0;for(let e=0;e<n;e++)l*=1+r,i+=l/Math.pow(1+a,e+1);return i+l*(1+s)/(a-s)/Math.pow(1+a,n)}r.d(t,{T:()=>a})},6747:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let a=require("alphavantage"),s=r.n(a)()({key:process.env.ALPHA_VANTAGE_API_KEY});async function n(e){try{return await s.fundamental.company_overview(e)}catch(e){return console.error("Error fetching fundamentals:",e),null}}},6120:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{U:()=>l});var s=r(9530),n=e([s]);function l(e,t,r){let a=e.map(e=>e/12),n=(0,s.mean)(...a),l=(0,s.std)(...a),i=[];for(let e=0;e<t;e++){let e=[],t=100;for(let a=0;a<12*r;a++){let r=2*(0,s.random)()-1,i=n+r*l;t*=1+i,e.push({period:a+1,value:t})}i.push(e)}return i}s=(n.then?(await n)():n)[0],a()}catch(e){a(e)}})},852:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{K:()=>d});var s=r(5158),n=r.n(s),l=r(9061),i=e([l]);function d(e,t,r){let a=new(n());return a.text("Value Lab Report",14,16),(0,l.default)(a,{startY:22,head:[["Ticker","CAGR","Max Drawdown","VaR (95%)","ES (95%)","Beta","Sharpe Ratio"]],body:Object.keys(t).map(e=>[e,`${(100*t[e].cagr).toFixed(2)} %`,`${(100*t[e].maxDD).toFixed(2)} %`,`${(100*t[e].var).toFixed(2)} %`,`${(100*t[e].es).toFixed(2)} %`,t[e].beta.toFixed(2),t[e].sharpe.toFixed(2)])}),a.addPage(),a.text("Monte Carlo Simulation",14,16),(0,l.default)(a,{startY:22,head:[["Simulation","Final Value"]],body:r.map((e,t)=>[`Simulation ${t+1}`,e[e.length-1].value.toFixed(2)])}),a}l=(i.then?(await i)():i)[0],a()}catch(e){a(e)}})},5346:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});var a=r(4809),s=r.n(a);async function n(e){try{let t=await s()(`https://api.example.com/sentiment?ticker=${e}`);return await t.json()}catch(e){return console.error("Error fetching market sentiment:",e),{sentiment:"neutral",score:.5}}}},6764:()=>{},5244:(e,t)=>{"use strict";var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},9394:e=>{"use strict";e.exports=require("chartjs-plugin-zoom")},5158:e=>{"use strict";e.exports=require("jspdf")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},4809:e=>{"use strict";e.exports=require("node-fetch")},6689:e=>{"use strict";e.exports=require("react")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},955:e=>{"use strict";e.exports=import("chart.js/auto")},9061:e=>{"use strict";e.exports=import("jspdf-autotable")},9530:e=>{"use strict";e.exports=import("mathjs")},690:e=>{"use strict";e.exports=import("next-themes")},1017:e=>{"use strict";e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[899],()=>r(1420));module.exports=a})();